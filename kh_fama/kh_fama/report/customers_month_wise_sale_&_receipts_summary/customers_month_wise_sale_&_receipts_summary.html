<style>
    @page {
        size: A4 landscape;
        margin: 15mm;
    }

    body {
        font-family: "Arial", sans-serif;
        font-size: 10pt;
        color: #000;
    }

	.total-row td {
		font-weight: bold;
		font-size: 10pt; /* slightly bigger */
		border: 2px solid #000; /* darker border */
		background-color: #f2f2f2; /* light gray for better visibility */
	}

    .report-header {
        text-align: left;
        margin-bottom: 10px;
        font-weight: bold;
    }

    .report-title {
        text-align: center;
        font-size: 12pt;
        font-weight: bold;
        margin-bottom: 10px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }

    th, td {
        border: 1px solid #000;
        padding: 3px;
        text-align: center;
        vertical-align: middle;
        font-size: 9pt;
    }

    th {
        background-color: #eaeaea;
        font-weight: bold;
    }

    .yellow {
        background-color: #ffff00 !important; /* Sale columns */
    }

    .company-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .footer-row td {
        font-weight: bold;
        text-align: center;
    }
</style>

<div class="report-header">
    <div class="company-info">
        <div>K. H. Fama Textile Processing (Pvt.) Ltd.</div>
        <div>Date: {{ frappe.datetime.str_to_user(frappe.datetime.get_today()) }}</div>
    </div>
    <div class="report-title">Customers Month Wise Sale & Receipts Summary</div>
</div>

<table>
    <thead>
        <tr>
            <th rowspan="2">Customer</th>
            <th rowspan="2">Opening</th>

            {% 
                var months = [];
                for (var i = 0; i < columns.length; i++) {
                    var col = columns[i];
                    if (col.label.includes("Receipts")) {
                        var month = col.label.replace(" Receipts", "");
                        months.push(month);
                    }
                }
            %}

            {% for (var j = 0; j < months.length; j++) { %}
                <th colspan="2">{{ months[j] }}</th>
            {% } %}

            <th rowspan="2">Ledger Balance</th>
        </tr>
        <tr>
            {% for (var j = 0; j < months.length; j++) { %}
                <th>Receipts</th>
                <th class="yellow">Sale</th>
            {% } %}
        </tr>
    </thead>

    <tbody>
		{% for (var i = 0; i < data.length; i++) { %}
			{% var is_total_row = (data[i]["customer"] == "Total"); %}
			<tr class="{{ is_total_row ? 'total-row' : '' }}">
				<td>{{ data[i]["customer"] || "" }}</td>
				<td>{{ frappe.format(data[i]["opening"] || 0, {fieldtype: "Currency"}) }}</td>

				{% for (var j = 0; j < months.length; j++) { %}
					{% 
						var m = months[j];
						var rec_field = m + "_receipts";
						var sale_field = m + "_sales";
					%}
					<td>{{ frappe.format(data[i][rec_field] || 0, {fieldtype: "Currency"}) }}</td>
					<td class="yellow">{{ frappe.format(data[i][sale_field] || 0, {fieldtype: "Currency"}) }}</td>
				{% } %}

				<td>{{ frappe.format(data[i]["customer_ledger"] || 0, {fieldtype: "Currency"}) }}</td>
			</tr>
		{% } %}
	</tbody>

</table>
